<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
        <title>Blog - Will Fuqua</title>
        <link media="all" href="/blog/style/pygments-nuvola.css" rel="stylesheet" />
        <link media="all" href="/blog/style/main.css" rel="stylesheet" />
        <link href="/favicon.ico" rel="shortcut icon" />
        <link href="/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Reenie+Beanie&amp;text=WilFqua" />
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Droid+Sans" />
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Inconsolata" />
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css" />
        <link href="/blog/atom/" type="application/atom+xml" rel="alternate" title="Atom Feed" />
        <link href="/blog/rss/" type="application/rss+xml" rel="alternate" title="RSS Feed" />
        <script>
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-38553935-1']);
            _gaq.push(['_trackPageview']);
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>
    <body>
        <header>
            <a href="/blog/" rel="contents home start" class="blogtitle"><span class="first-name">Will</span><span class="last-name">Fuqua</span></a>
        </header>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Parsing PowerShell Programatically</h1>
    <p>I've recently been working with a lot of PowerShell at work, and the experience has been, well, less than perfect. PowerShell is a dynamically-typed scripting language, and is most often used for administering Windows systems. The combination of making system changes and the runtime errors associated with dynamically-typed languages has been frustrating. It's quite common to get the system into a weird or inconsistent state when developing PowerShell scripts.</p>
<p>Ideally all your PowerShell is properly orchestrated with <tt class="docutils literal"><span class="pre">-WhatIf</span></tt> and <tt class="docutils literal">SupportsShouldProcess</tt> functionality, but in my experience it's common for there to be large differences in behavior between <tt class="docutils literal"><span class="pre">-WhatIf</span></tt> execution and real execution.</p>
<p>The <span>&#8230;<a href="/blog/2017/12/parsing-powershell-programatically/" class="continue">continue</a>.</span></p>
    <div class="tags">
         tagged as <a href="/blog/tag/powershell/" rel="tag">powershell</a> and  <a href="/blog/tag/csharp/" rel="tag">csharp</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Level up your VsVim</h1>
    

<p>If you're like me, you installed Visual Studio, installed <a class="reference external" href="https://github.com/jaredpar/VsVim">VsVim</a>, and then happily started coding. However, did you know that Visual Studio's semantic understanding and manipulation of your code is exposed to VsVim?</p>
<p>For example, you might already know that pressing <tt class="docutils literal">gd</tt> in VsVim will &quot;go to the definition&quot; of a method. But what if we want to &quot;go to the implementation&quot; e.g. through an interface to the underlying concrete method? The standard <tt class="docutils literal"><span class="pre">Ctrl-F12</span></tt> requires some contortions, and maybe requires glancing down at your keyboard.</p>
<p>It's easy to fix this; just add this mapping to your <tt class="docutils literal">~\_vsvimrc</tt>:</p>
<div class="highlight"><pre><span></span>map gi :vsc Edit.GoToImplementation&lt;CR&gt;
</pre></div>
<p>Let's break this <span>&#8230;<a href="/blog/2017/08/level-up-your-vsvim/" class="continue">continue</a>.</span></p>
    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a>, <a href="/blog/tag/vim/" rel="tag">vim</a> and  <a href="/blog/tag/visual-studio/" rel="tag">visual-studio</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>The Implementation of C# Local Functions</h1>
    <p>C# 7 local functions provide a more intuitive syntax over creating verbose System.Func delegates, as well as being more capable (they support ref and out parameters, async, generics, etc). In addition, some articles have mentioned that local functions compile down to normal methods, thus reducing GC allocations when compared to System.Func.</p>
<p>I was curious about that last part. How does it work? Let's open up the dotPeek decompiler and find out!</p>
<p>First, here's a simple test program using a local function:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">AddFive</span><span class="p">(</span><span class="m">7</span><span class="p">));</span>
  </pre><span>&#8230;<a href="/blog/2017/07/the-implementation-of-csharp-local-functions/" class="continue">continue</a>.</span></div>
    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a> and  <a href="/blog/tag/language/" rel="tag">language</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Solving the Zebra Puzzle with LINQ and C# 7</h1>
    <p>I recently ran across <a class="reference external" href="https://en.wikipedia.org/wiki/Zebra_Puzzle">the Zebra Puzzle</a>, a logic puzzle from about 50 years&nbsp;ago:</p>
<blockquote>
<ol class="arabic simple">
<li>There are five&nbsp;houses.</li>
<li>The Englishman lives in the red&nbsp;house.</li>
<li>The Spaniard owns the&nbsp;dog.</li>
<li>Coffee is drunk in the green&nbsp;house.</li>
<li>The Ukrainian drinks&nbsp;tea.</li>
<li>The green house is immediately to the right of the ivory&nbsp;house.</li>
<li>The Old Gold smoker owns&nbsp;snails.</li>
<li>Kools are smoked in the yellow&nbsp;house.</li>
<li>Milk is drunk in the middle&nbsp;house.</li>
<li>The Norwegian lives in the first&nbsp;house.</li>
<li>The man who smokes Chesterfields lives in the house next to the man with the&nbsp;fox.</li>
<li>Kools are smoked in the house next to the house where the horse is&nbsp;kept.</li>
<li>The Lucky Strike smoker drinks orange&nbsp;juice.</li>
<li>The Japanese smokes&nbsp;Parliaments.</li>
<li>The Norwegian lives next to the blue&nbsp;house.</li>
</ol>
<p>Now, <span>&#8230;<a href="/blog/2017/01/solving-the-zebra-puzzle-with-linq-and-c-7/" class="continue">continue</a>.</span></p></blockquote>
    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a> and  <a href="/blog/tag/linq/" rel="tag">linq</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Finding Dead C# Code in an ASP.NET application</h1>
    <p>Large, long-lasting codebases tend to accumulate unused code, or dead code, over time. This happens as features are added, changed and removed.</p>
<p>Some types of dead code, like unreferenced methods, are easy to detect with Visual Studio's out-of-the-box static analysis. However, other types of dead code are trickier; maybe there's a method that's only referenced by unit tests, or it's referenced under a condition that's never valid:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span> <span class="p">&lt;</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
<span class="p">{</span>
    <span class="c1">// some dead code</span>
<span class="p">}</span>
</pre></div>
<p>How can we detect this type of dead code? Rather than using static analysis to detect it, we can use dynamic analysis---the <span>&#8230;<a href="/blog/2016/08/finding-dead-csharp-code-in-aspnet/" class="continue">continue</a>.</span></p>
    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a>, <a href="/blog/tag/analysis/" rel="tag">analysis</a> and  <a href="/blog/tag/opencover/" rel="tag">opencover</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Increasing Code Quality with SonarQube</h1>
    <p>I just posted an article about SonarQube, an open source static analysis tool, and how we set it up to scan every incoming GitHub pull request at work.</p>
<p>You can <a class="reference external" href="http://techblog.jetabroad.com/2016/06/increasing-code-quality-with-sonarqube.html">read it at the Jetabroad Tech Blog</a>.</p>

    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a>, <a href="/blog/tag/analysis/" rel="tag">analysis</a> and  <a href="/blog/tag/sonarqube/" rel="tag">sonarqube</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Quick Tip: Format Finder for .NET date strings</h1>
    <p>If you've written C# for any length of time, chances are you've become very familiar with the MSDN documentation pages about <a class="reference external" href="https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx">Standard Date and Time Format Strings</a> and <a class="reference external" href="https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom Date and Time Format Strings</a>. Any time you need to format a <tt class="docutils literal">DateTime</tt>, those pages are invaluable.</p>
<p>I don't find myself reading those pages often enough to warrant memorizing the strings, but I do read them often enough that it's worth automating the lookup. So I wrote a simple webapp to do it.</p>

<p>I plan on skewing those curves by sharing this tool. So, here it is: <a class="reference external" href="https://fuqua.io/format-finder/">Format Finder</a>.</p>
<p>Format Finder presents you with <span>&#8230;<a href="/blog/2015/02/quick-tip-format-finder-for-net-date-strings/" class="continue">continue</a>.</span></p>
    <div class="tags">
         tagged as <a href="/blog/tag/csharp/" rel="tag">csharp</a>, <a href="/blog/tag/tools/" rel="tag">tools</a> and  <a href="/blog/tag/dates/" rel="tag">dates</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
            <nav>
    <ul>
        <li><a class="top" href="#" title="Top of page"><i class="icon-chevron-up"></i></a><span class="label">Top&nbsp;of&nbsp;page</span></li>
        <li><a class="root" href="https://fuqua.io/blog" title="Home"><i class="icon-home"></i></a><span class="label">Home</span></li>
        <li><a class="dark-mode" href="#" title="Switch Light/Dark Mode" onclick="toggleDarkMode()"><i class="icon-adjust"></i></a><span class="label">Light/Dark</span></li>
        <li><a class="bottom" href="#comments" title="Comments"><i class="icon-chevron-down"></i></a><span class="label">Comments</span></li>
    </ul>
</nav>
<article>
    <h1>Haskell's Elegant Fibonacci Implementation in C#</h1>
    <p><a class="reference external" href="http://www.haskell.org/haskellwiki/Introduction">Haskell</a> is a high-level, functional, programming language. Its combination of higher-order functions and lazy evaluation can lead to beautifully elegant algorithm implementations. One such implementation is the <a class="reference external" href="http://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci series</a> algorithm:</p>
<div class="highlight"><pre><span></span><span class="kr">let</span> <span class="n">fib</span> <span class="ow">=</span> <span class="mi">1</span> <span class="kt">:</span> <span class="mi">1</span> <span class="kt">:</span> <span class="n">zipWith</span> <span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="n">fib</span> <span class="p">(</span><span class="n">tail</span> <span class="n">fib</span><span class="p">)</span>
</pre></div>
<p>This creates a variable called <tt class="docutils literal">fib</tt> that contains an infinite sequence of Fibonacci numbers. We could print this variable, but our program would start trying to print an infinite number of elements. A better approach is to choose a finite number of elements from the sequence:</p>
<div class="highlight"><pre><span></span><span class="nf">take</span> <span class="mi">10</span> <span class="n">fib</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">55</span><span class="p">]</span>
</pre></div>
<p>The above implementation of <tt class="docutils literal">fib</tt> fascinates me, so I decided to try my <span>&#8230;<a href="/blog/2014/03/haskells-elegant-fibonacci-in-csharp/" class="continue">continue</a>.</span></p>
    <div class="tags">
         tagged as <a href="/blog/tag/haskell/" rel="tag">haskell</a>, <a href="/blog/tag/csharp/" rel="tag">csharp</a>, <a href="/blog/tag/fibonacci/" rel="tag">fibonacci</a> and  <a href="/blog/tag/functional/" rel="tag">functional</a>  
    </div>
    
</article>
<script>
    function toggleDarkMode() {
        const classList = document.documentElement.classList;
        const userPreferenceDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const manualDarkMode = classList.contains('dark');

        if (classList.length == 0) {
            classList.add(userPreferenceDarkMode ? 'light' : 'dark');
        } else {
            classList.replace(manualDarkMode ? 'dark' : 'light', manualDarkMode ? 'light' : 'dark');
        }
        return false;
    }
</script>
        
        <div class="pager">
        
        
            <a href="/blog/tag/csharp/" class="next">
            &#x21DC; Next
            </a>
        </div>
<script src="/blog/script/list.min.js"></script>
    </body>
</html>